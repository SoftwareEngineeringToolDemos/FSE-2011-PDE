// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 10.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace Tum.PDE.ToolFramework.Templates.Shell.ViewModel.WPFApplication
{
    using Tum.PDE.LanguageDSL;
    using Microsoft.VisualStudio.Modeling;
    using System.Collections;
    using System.Collections.Generic;
    using System.Collections.ObjectModel;
    using System.Linq;
    using System;
    
    
    #line 1 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
    [System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "10.0.0.0")]
    public partial class UIGenerator : BaseTemplate
    {
        #region ToString Helpers
        /// <summary>
        /// Utility class to produce culture-oriented representation of an object as a string.
        /// </summary>
        public class ToStringInstanceHelper
        {
            private System.IFormatProvider formatProviderField  = global::System.Globalization.CultureInfo.InvariantCulture;
            /// <summary>
            /// Gets or sets format provider to be used by ToStringWithCulture method.
            /// </summary>
            public System.IFormatProvider FormatProvider
            {
                get
                {
                    return this.formatProviderField ;
                }
                set
                {
                    if ((value != null))
                    {
                        this.formatProviderField  = value;
                    }
                }
            }
            /// <summary>
            /// This is called from the compile/run appdomain to convert objects within an expression block to a string
            /// </summary>
            public string ToStringWithCulture(object objectToConvert)
            {
                if ((objectToConvert == null))
                {
                    throw new global::System.ArgumentNullException("objectToConvert");
                }
                System.Type t = objectToConvert.GetType();
                System.Reflection.MethodInfo method = t.GetMethod("ToString", new System.Type[] {
                            typeof(System.IFormatProvider)});
                if ((method == null))
                {
                    return objectToConvert.ToString();
                }
                else
                {
                    return ((string)(method.Invoke(objectToConvert, new object[] {
                                this.formatProviderField })));
                }
            }
        }
        private ToStringInstanceHelper toStringHelperField = new ToStringInstanceHelper();
        public ToStringInstanceHelper ToStringHelper
        {
            get
            {
                return this.toStringHelperField;
            }
        }
        #endregion
        public override string TransformText()
        {
            this.GenerationEnvironment = null;
            this.Write(" \r\n");
            
            #line 9 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
 
	GenerateUI(this.MetaModel);

            
            #line default
            #line hidden
            return this.GenerationEnvironment.ToString();
        }
        
        #line 12 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
 
public void GenerateUI(MetaModel dm)
{

        
        #line default
        #line hidden
        
        #line 15 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(@"using DslEditorContracts = Tum.PDE.ToolFramework.Modeling.Visualization.Contracts;
using DslEditorPopups   = Tum.PDE.ToolFramework.Modeling.Visualization.Controls.Popups;
using DslEditorServices = Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel.Services;
using DslEditorCommands = Tum.PDE.ToolFramework.Modeling.Visualization.Commands;
using DslEditorDiagramSurface = Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel.DiagramSurface;

using WPFRibbon = Fluent;

using System;
using System.ComponentModel.Composition;
using System.ComponentModel.Composition.Hosting;
using System.Reflection;
using System.Windows.Controls;

using ");

        
        #line default
        #line hidden
        
        #line 30 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Namespace));

        
        #line default
        #line hidden
        
        #line 30 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(".ViewModel;\r\n\r\nnamespace ");

        
        #line default
        #line hidden
        
        #line 32 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Namespace));

        
        #line default
        #line hidden
        
        #line 32 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(".View\r\n{\r\n\t/// <summary>\r\n    /// This class is used as a base class for the main" +
        " window of the editor.\r\n    /// </summary>\r\n\tpublic abstract class DslPluginMain" +
        "Control : UserControl\r\n\t{\r\n\t\t/// <summary>\r\n        /// ");

        
        #line default
        #line hidden
        
        #line 40 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Name));

        
        #line default
        #line hidden
        
        #line 40 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(" Modeling document data.\r\n        /// </summary>\r\n        protected ");

        
        #line default
        #line hidden
        
        #line 42 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 42 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write("DocumentData DocData = null;\r\n\t\t\r\n        /// <summary>\r\n        /// ");

        
        #line default
        #line hidden
        
        #line 45 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Name));

        
        #line default
        #line hidden
        
        #line 45 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(" Main view model.\r\n        /// </summary>\r\n        protected ");

        
        #line default
        #line hidden
        
        #line 47 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Name));

        
        #line default
        #line hidden
        
        #line 47 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(@"MainViewModel ViewModel = null;		

		/*
        /// <summary>
        /// Imported plugins which suffice to the IPlugin interface.
        /// </summary>
		[ImportMany(typeof(DslEditorContracts::IPlugin))]
        public System.Collections.Generic.List<DslEditorContracts::IPlugin> SimplePlugins { get; set; }

		/// <summary>
        /// Imported plugins which suffice to the IPlugin interface.
        /// </summary>
		[ImportMany(typeof(DslEditorContracts::IModelPlugin))]
        public System.Collections.Generic.List<DslEditorContracts::IModelPlugin> SimpleModelPlugins { get; set; }
	
		/// <summary>
        /// Imported plugins which suffice to the IViewModelPlugin interface.
        /// </summary>
        [ImportMany(typeof(DslEditorContracts::IViewModelPlugin))]
        public System.Collections.Generic.List<DslEditorContracts::IViewModelPlugin> ViewModelPlugins { get; set; }
		*/
	
        /// <summary>
        /// Plugins directory.
        /// </summary>
        public const string PluginsDirectory = ""plugins"";

		/// <summary>
        /// Constructor.
        /// </summary>
		public DslPluginMainControl()
		{        
			
		}
		
		/// <summary>
        /// Sets view model.
        /// </summary>
        /// <param name=""viewModel"">VM.</param>
		public virtual void SetViewModel(");

        
        #line default
        #line hidden
        
        #line 86 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(this.MetaModel.Namespace));

        
        #line default
        #line hidden
        
        #line 86 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(".ViewModel.");

        
        #line default
        #line hidden
        
        #line 86 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(this.MetaModel.Name));

        
        #line default
        #line hidden
        
        #line 86 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"
this.Write("MainViewModel viewModel)\r\n\t\t{\r\n\t\t\ttry\r\n            {           \r\n\t\t\t\tthis.ViewMod" +
        "el = viewModel;\r\n                this.DataContext = viewModel;\r\n\r\n            \tv" +
        "iewModel.Ribbon = this.Ribbon;\r\n\t\t\t\tviewModel.RestoreLayout();\r\n\t\t\t}\r\n\t\t\tcatch (" +
        "System.Exception ex)\r\n            {\r\n\t\t\t\tSystem.Windows.MessageBox.Show(\"Error d" +
        "uring initialization: \" + ex.Message);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Register known windows\r" +
        "\n\t\t\tDslEditorServices::IUIVisualizerService popupVisualizer = ViewModel.GlobalSe" +
        "rviceProvider.Resolve<DslEditorServices::IUIVisualizerService>();\t\t\t\t\r\n\t\t\tpopupV" +
        "isualizer.TryRegister(\"SelectElementPopup\", typeof(DslEditorPopups::SelectElemen" +
        "tPopup));\r\n\t\t\tpopupVisualizer.TryRegister(\"DeleteElementsPopup\", typeof(DslEdito" +
        "rPopups::DeleteElementsPopup));\t\t\t\t\r\n\t\t\tpopupVisualizer.TryRegister(\"SelectEleme" +
        "ntWithRSTypePopup\", typeof(DslEditorPopups::SelectElementWithRSTypePopup));\r\n\t\t\t" +
        "popupVisualizer.TryRegister(\"SelectRSTypePopup\", typeof(DslEditorPopups::SelectR" +
        "STypePopup));\r\n\t\t\t\t\r\n\t\t\t/*\r\n            try\r\n            {\r\n                // l" +
        "oad plugins\r\n                LoadPlugins();\r\n            }\r\n            catch (S" +
        "ystem.Exception ex)\r\n            {\r\n                System.Windows.MessageBox.Sh" +
        "ow(\"Error during plugin loading: \" + ex.Message);\r\n            }*/\r\n\t\t}\r\n\t\t\r\n\t\t/" +
        "*\r\n\t\t/// <summary>\r\n        /// Load plugins.\r\n        /// </summary>\r\n\t\tpublic " +
        "virtual void LoadPlugins()\r\n\t\t{\r\n\t\t\ttry\r\n            {\r\n\t\t\t\tstring path = Assemb" +
        "ly.GetAssembly(this.GetType()).Location;\r\n                string dir = new Syste" +
        "m.IO.FileInfo(path).Directory.FullName;\r\n\r\n                string fullDir = dir " +
        "+ System.IO.Path.DirectorySeparatorChar + PluginsDirectory;\r\n\r\n\r\n\t\t\t\t// Load plu" +
        "gins\r\n                if (!System.IO.Directory.Exists(fullDir))\r\n               " +
        "     System.IO.Directory.CreateDirectory(fullDir);\r\n\r\n                DirectoryC" +
        "atalog directoryCatalog = new DirectoryCatalog(fullDir);\r\n\t\t\t\tCompositionContain" +
        "er container = new CompositionContainer(directoryCatalog);\r\n            \tcontain" +
        "er.ComposeParts(this);\r\n\t\t\t\t\r\n\t\t\t\tif( SimplePlugins.Count > 0 )\r\n\t\t\t\t{\r\n\t\t\t\t\tfor" +
        "each(DslEditorContracts::IPlugin plugin in SimplePlugins)\r\n\t\t\t\t\t\tforeach (Tum.PD" +
        "E.ToolFramework.Modeling.Visualization.ViewModel.ModelContextViewModel mcVM in V" +
        "iewModel.AvailableModelModelContextViewModels)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif( plugin.Model" +
        "Context == mcVM.ModelContext.Name || plugin.ModelContext == null)\r\n\t\t\t\t\t\t\t\tmcVM." +
        "AddPlugin(plugin);\r\n\t\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif( SimpleModelPlugins.Count >" +
        " 0 )\r\n\t\t\t\t{\r\n\t\t\t\t\tforeach(DslEditorContracts::IModelPlugin plugin in SimpleModel" +
        "Plugins)\r\n\t\t\t\t\t\tforeach (Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel." +
        "ModelContextViewModel mcVM in ViewModel.AvailableModelModelContextViewModels)\r\n\t" +
        "\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif( plugin.ModelContext == mcVM.ModelContext.Name || plugin.Model" +
        "Context == null)\r\n\t\t\t\t\t\t\t\tmcVM.AddPlugin(plugin);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tplugin.SetVi" +
        "ewModelStore(ViewModel.ViewModelStore);\r\n\t\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif( ViewM" +
        "odelPlugins.Count > 0 )\r\n\t\t\t\t{\r\n\t\t\t\t\tforeach(DslEditorContracts::IViewModelPlugi" +
        "n plugin in ViewModelPlugins)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttry\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tDslEditorDiagr" +
        "amSurface::BaseDiagramSurfaceViewModel vm = plugin.GetViewModel(ViewModel.ViewMo" +
        "delStore);\r\n\t\t\t\t\t\t\tif( vm != null )\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tforeach (Tum.PDE.ToolFram" +
        "ework.Modeling.Visualization.ViewModel.ModelContextViewModel mcVM in ViewModel.A" +
        "vailableModelModelContextViewModels)\r\n                                    if (pl" +
        "ugin.ModelContext == null)\r\n                                        mcVM.AddPlug" +
        "inViewModel(vm);\r\n                                    else if( plugin.ModelConte" +
        "xt == mcVM.ModelContext.Name)\r\n                                        mcVM.AddP" +
        "luginViewModel(vm);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tSystem.Windows.ResourceDictionary diction" +
        "ary = plugin.GetViewModelRessourceDictionary();\r\n\t\t\t\t\t\t\t\tif( dictionary != null " +
        ")\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tSystem.Windows.Application.Current.Resources.BeginInit();" +
        "\r\n\t\t\t\t\t\t            System.Windows.Application.Current.Resources.MergedDictionar" +
        "ies.Add(dictionary);\r\n            \t\t\t\t\t\tSystem.Windows.Application.Current.Resou" +
        "rces.EndInit();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcatch (System.Exception ex)" +
        "\r\n            \t\t\t{\r\n                \t\t\tSystem.Windows.MessageBox.Show(ex.Message" +
        ");\r\n            \t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n            }\r\n            catch (System.Ex" +
        "ception ex)\r\n            {\r\n                System.Windows.MessageBox.Show(ex.Me" +
        "ssage);\r\n            }\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\t/// <summary>\r\n        /// Gets the WPF r" +
        "ibbon instance.\r\n        /// </summary>\r\n\t\tpublic abstract WPFRibbon::Ribbon Rib" +
        "bon{ get; }\r\n\t\t\r\n        /// <summary>\r\n        /// Clean up.\r\n        /// </sum" +
        "mary>\r\n        public virtual void Dispose()\r\n        {\r\n\t\t\tthis.DataContext = n" +
        "ull;\r\n\t\t\r\n            if (this.ViewModel != null)\r\n            {\r\n              " +
        "  // Unregister known windows\r\n\t\t\t\t/*\r\n                DslEditorServices::IUIVis" +
        "ualizerService popupVisualizer = ViewModel.GlobalServiceProvider.Resolve<DslEdit" +
        "orServices::IUIVisualizerService>();\r\n                popupVisualizer.Unregister" +
        "(\"SelectElementPopup\");\r\n                popupVisualizer.Unregister(\"DeleteEleme" +
        "ntsPopup\");\r\n                popupVisualizer.Unregister(\"SelectElementWithRSType" +
        "Popup\");\r\n                popupVisualizer.Unregister(\"SelectRSTypePopup\");*/\r\n\r\n" +
        "                this.ViewModel.Dispose();\r\n            }\r\n\t\t}\t\t\r\n\t}\r\n}\r\n");

        
        #line default
        #line hidden
        
        #line 229 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\Shell\ViewModel\WPFApplication\UIGenerator.tt"

}

        
        #line default
        #line hidden
    }
    
    #line default
    #line hidden
}
