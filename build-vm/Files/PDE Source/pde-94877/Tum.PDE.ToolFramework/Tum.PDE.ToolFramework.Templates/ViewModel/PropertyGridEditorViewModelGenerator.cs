// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 10.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace Tum.PDE.ToolFramework.Templates.ViewModel
{
    using Tum.PDE.LanguageDSL;
    using System.Collections;
    using System.Collections.Generic;
    using System.Collections.ObjectModel;
    using System.Linq;
    using System;
    
    
    #line 1 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
    [System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "10.0.0.0")]
    public partial class PropertyGridEditorViewModelGenerator : BaseTemplate
    {
        #region ToString Helpers
        /// <summary>
        /// Utility class to produce culture-oriented representation of an object as a string.
        /// </summary>
        public class ToStringInstanceHelper
        {
            private System.IFormatProvider formatProviderField  = global::System.Globalization.CultureInfo.InvariantCulture;
            /// <summary>
            /// Gets or sets format provider to be used by ToStringWithCulture method.
            /// </summary>
            public System.IFormatProvider FormatProvider
            {
                get
                {
                    return this.formatProviderField ;
                }
                set
                {
                    if ((value != null))
                    {
                        this.formatProviderField  = value;
                    }
                }
            }
            /// <summary>
            /// This is called from the compile/run appdomain to convert objects within an expression block to a string
            /// </summary>
            public string ToStringWithCulture(object objectToConvert)
            {
                if ((objectToConvert == null))
                {
                    throw new global::System.ArgumentNullException("objectToConvert");
                }
                System.Type t = objectToConvert.GetType();
                System.Reflection.MethodInfo method = t.GetMethod("ToString", new System.Type[] {
                            typeof(System.IFormatProvider)});
                if ((method == null))
                {
                    return objectToConvert.ToString();
                }
                else
                {
                    return ((string)(method.Invoke(objectToConvert, new object[] {
                                this.formatProviderField })));
                }
            }
        }
        private ToStringInstanceHelper toStringHelperField = new ToStringInstanceHelper();
        public ToStringInstanceHelper ToStringHelper
        {
            get
            {
                return this.toStringHelperField;
            }
        }
        #endregion
        public override string TransformText()
        {
            this.GenerationEnvironment = null;
            this.Write(" \r\n");
            this.Write(@"using DslModeling = global::Microsoft.VisualStudio.Modeling;
using DslEditorModeling = global::Tum.PDE.ToolFramework.Modeling;
using DslEditorViewModelData = global::Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel.Data;
using DslEditorViewModelPGrid = global::Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel.PropertyGrid;
using DslEditorViewModelServices = global::Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel.Services;
using DslEditorViewModelDeletion = global:: Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel.Deletion;

");
            
            #line 15 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"

	foreach(PropertyGridEditor p in this.MetaModel.PropertyGridEditors)
	{
		if( p.Name == "ReferencedModelRoleViewModel" && 
			p.Namespace == "Tum.PDE.ToolFramework.Modeling.Visualization.VMXExtensions.Path" )
		{
			GenerateReferencedModelRoleViewModel(this.MetaModel, p);
			continue;
		}
						
		if( p.ShouldBeGenerated )
			GeneratePropertyGridEditorViewModel(this.MetaModel, p);
	}

            
            #line default
            #line hidden
            return this.GenerationEnvironment.ToString();
        }
        
        #line 29 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
 
public void GeneratePropertyGridEditorViewModel(MetaModel dm, PropertyGridEditor editor)
{
	string baseClass = "DslEditorViewModelPGrid::" + editor.EditorBaseType.ToString();

        
        #line default
        #line hidden
        
        #line 33 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("namespace ");

        
        #line default
        #line hidden
        
        #line 34 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Namespace));

        
        #line default
        #line hidden
        
        #line 34 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("\r\n{\r\n    /// <summary>\r\n    /// ");

        
        #line default
        #line hidden
        
        #line 37 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 37 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(".\r\n\t///\r\n\t/// Double derived to allow easier customization.\r\n    /// </summary>\r\n" +
        "\tpublic partial class ");

        
        #line default
        #line hidden
        
        #line 41 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 41 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(" : ");

        
        #line default
        #line hidden
        
        #line 41 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 41 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("Base\r\n\t{\r\n\t\t#region Constructor\r\n\t\t/// <summary>\r\n        /// Constuctor.\r\n      " +
        "  /// </summary>\r\n        /// <param name=\"viewModelStore\">The store this view m" +
        "odel belongs to.</param>\r\n        public ");

        
        #line default
        #line hidden
        
        #line 48 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 48 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("(DslEditorViewModelData::ViewModelStore viewModelStore)\r\n            : base(viewM" +
        "odelStore)\r\n        {\r\n            \r\n        }\r\n\t\t#endregion\r\n\t}\r\n\t\r\n    /// <su" +
        "mmary>\r\n    /// ");

        
        #line default
        #line hidden
        
        #line 57 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 57 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(".\r\n\t///\r\n\t/// This is the base abstract class.\r\n    /// </summary>\r\n\tpublic abstr" +
        "act partial class ");

        
        #line default
        #line hidden
        
        #line 61 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 61 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("Base : ");

        
        #line default
        #line hidden
        
        #line 61 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(baseClass));

        
        #line default
        #line hidden
        
        #line 61 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("\r\n\t{\r\n\t\t#region Constructor\r\n\t\t/// <summary>\r\n        /// Constuctor.\r\n        //" +
        "/ </summary>\r\n        /// <param name=\"viewModelStore\">The store this view model" +
        " belongs to.</param>\r\n        protected ");

        
        #line default
        #line hidden
        
        #line 68 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 68 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@"Base(DslEditorViewModelData::ViewModelStore viewModelStore)
            : base(viewModelStore)
        {
            InitializePropertyGridEditorVM();
        }
		#endregion	
		
		#region Initialization
		/// <summary>
        /// Initializes the property grid editor vm. Override this method to supply custom initialization.
        /// </summary>		
		public virtual void InitializePropertyGridEditorVM()
		{
		}
		#endregion
");

        
        #line default
        #line hidden
        
        #line 83 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"

	if( editor.RequiresContextMenuBar)
	{

        
        #line default
        #line hidden
        
        #line 86 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("\r\n\t\t#region Ribbon Menu Bar\r\n\t\tpublic partial class ");

        
        #line default
        #line hidden
        
        #line 89 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 89 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("ContextMenuBarCreater : DslEditorViewModelPGrid::ContextMenuBarCreater\r\n\t\t{\r\n\t\t\t#" +
        "region Singleton Instance\r\n\t\t\t/// <summary>\r\n\t\t\t/// Singleton instance.\r\n\t\t\t/// " +
        "</summary>\r\n\t\t\tprivate static ");

        
        #line default
        #line hidden
        
        #line 95 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 95 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@"ContextMenuBarCreater instance;
			/// <summary>
			/// Singleton instance.
			/// </summary>
			[global::System.Diagnostics.DebuggerBrowsable(global::System.Diagnostics.DebuggerBrowsableState.Never)] // Will trigger creation otherwise.
			public static ");

        
        #line default
        #line hidden
        
        #line 100 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 100 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("ContextMenuBarCreater Instance\r\n\t\t\t{\r\n\t\t\t\t[global::System.Diagnostics.DebuggerSte" +
        "pThrough]\r\n\t\t\t\tget\r\n\t\t\t\t{\r\n\t\t\t\t\tif (");

        
        #line default
        #line hidden
        
        #line 105 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 105 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("ContextMenuBarCreater.instance == null)\r\n\t\t\t\t\t\t");

        
        #line default
        #line hidden
        
        #line 106 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 106 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("ContextMenuBarCreater.instance = new ");

        
        #line default
        #line hidden
        
        #line 106 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 106 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("ContextMenuBarCreater();\r\n\t\t\t\t\treturn ");

        
        #line default
        #line hidden
        
        #line 107 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 107 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("ContextMenuBarCreater.instance;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t#endregion\r\n\t\t\t\r\n\t\t\t#region Cons" +
        "tructor\r\n\t\t    /// <summary>\r\n\t\t\t/// Constructor.\r\n    \t\t/// </summary>\t\t\t\r\n\t\t\tp" +
        "rivate ");

        
        #line default
        #line hidden
        
        #line 116 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 116 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("ContextMenuBarCreater()\r\n\t\t\t{\r\n\t\t\t}\r\n\t\t\t#endregion\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t#endregion\r\n");

        
        #line default
        #line hidden
        
        #line 123 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"

	}

        
        #line default
        #line hidden
        
        #line 125 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("\t\r\n\t}\r\n}\r\n");

        
        #line default
        #line hidden
        
        #line 128 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"

}

public void GenerateReferencedModelRoleViewModel(MetaModel dm, PropertyGridEditor editor)
{
	if( editor.DomainRoles.Count == 0 )
		return;
	
	foreach(DomainRole role in editor.DomainRoles)
	{
		string name = role.Relationship.Name + role.Relationship.Target.Name;
		DomainClass sourceClass = role.Relationship.Source.RolePlayer as DomainClass;
		DomainClass targetClass = role.Relationship.Target.RolePlayer as DomainClass;

        
        #line default
        #line hidden
        
        #line 141 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("namespace ");

        
        #line default
        #line hidden
        
        #line 142 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Namespace));

        
        #line default
        #line hidden
        
        #line 142 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("\r\n{\t\t\r\n    /// <summary>\r\n    /// ");

        
        #line default
        #line hidden
        
        #line 145 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 145 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(" for ");

        
        #line default
        #line hidden
        
        #line 145 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Name));

        
        #line default
        #line hidden
        
        #line 145 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 145 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Target.Name));

        
        #line default
        #line hidden
        
        #line 145 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(".\r\n\t///\r\n\t/// Double derived to allow easier customization.\r\n    /// </summary>\r\n" +
        "\tpublic partial class ");

        
        #line default
        #line hidden
        
        #line 149 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(name));

        
        #line default
        #line hidden
        
        #line 149 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("RMRViewModel : ");

        
        #line default
        #line hidden
        
        #line 149 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(name));

        
        #line default
        #line hidden
        
        #line 149 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("RMRViewModelBase\r\n\t{\r\n\t\t#region Constructor\r\n\t\t/// <summary>\r\n        /// Constuc" +
        "tor.\r\n        /// </summary>\r\n        /// <param name=\"viewModelStore\">The store" +
        " this view model belongs to.</param>\r\n        public ");

        
        #line default
        #line hidden
        
        #line 156 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(name));

        
        #line default
        #line hidden
        
        #line 156 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("RMRViewModel(DslEditorViewModelData::ViewModelStore viewModelStore)\r\n            " +
        ": base(viewModelStore)\r\n        {\r\n            \r\n        }\r\n\t\t#endregion\r\n\t}\r\n\t\r" +
        "\n    /// <summary>\r\n    /// ");

        
        #line default
        #line hidden
        
        #line 165 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(editor.Name));

        
        #line default
        #line hidden
        
        #line 165 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(" for ");

        
        #line default
        #line hidden
        
        #line 165 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Name));

        
        #line default
        #line hidden
        
        #line 165 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(".");

        
        #line default
        #line hidden
        
        #line 165 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Target.Name));

        
        #line default
        #line hidden
        
        #line 165 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(".\r\n\t///\r\n\t/// This is the base abstract class.\r\n    /// </summary>\r\n\tpublic abstr" +
        "act partial class ");

        
        #line default
        #line hidden
        
        #line 169 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(name));

        
        #line default
        #line hidden
        
        #line 169 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@"RMRViewModelBase : Tum.PDE.ToolFramework.Modeling.Visualization.VMXExtensions.Path.ReferencedModelRoleViewModel
	{
		#region Constructor
		/// <summary>
        /// Constuctor.
        /// </summary>
        /// <param name=""viewModelStore"">The store this view model belongs to.</param>
        public ");

        
        #line default
        #line hidden
        
        #line 176 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(name));

        
        #line default
        #line hidden
        
        #line 176 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@"RMRViewModelBase(DslEditorViewModelData::ViewModelStore viewModelStore)
            : base(viewModelStore)
        {
            
        }
		#endregion	
		
		#region Properties
        /// <summary>
        /// Gets whether a model is referenced in this reference model or not.
        /// </summary>
        public override bool IsReferencedModelSet
        {
            get
            {
                if ((this.Elements[0] as ");

        
        #line default
        #line hidden
        
        #line 191 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(sourceClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 191 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(").");

        
        #line default
        #line hidden
        
        #line 191 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Source.PropertyName));

        
        #line default
        #line hidden
        
        #line 191 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@" != null)
                    return true;
                else
                    return false;
            }
        }

        /// <summary>
        /// Gets the filter string for the open/save file dialog.
        /// </summary>
        public override string FileDialogFilter
        {
            get
			{
				return """);

        
        #line default
        #line hidden
        
        #line 205 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(targetClass.DisplayName));

        
        #line default
        #line hidden
        
        #line 205 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@" files|*.xml|All files|*.*"";
			}
        }		
		#endregion
		
		#region Methods
		/// <summary>
        /// Converts the property value and returns the converted value.
        /// </summary>
        /// <returns>Converted property value.</returns>
        public override object GetPropertyValue()
        {
			");

        
        #line default
        #line hidden
        
        #line 217 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(sourceClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 217 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(" model = this.Elements[0] as ");

        
        #line default
        #line hidden
        
        #line 217 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(sourceClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 217 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(";\r\n\t\t\t\r\n\t\t\tif( model.");

        
        #line default
        #line hidden
        
        #line 219 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Source.PropertyName));

        
        #line default
        #line hidden
        
        #line 219 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@" == null )
				return """";
			
			DslEditorModeling::IParentModelElement parent = model.GetDomainModelServices().ElementParentProvider.GetParentModelElement(model);
            if (parent == null)
                throw new System.ArgumentNullException(""Parent of element "" + model.ToString() + "" can not be null"");
			
			string path = parent.DomainFilePath;
            string vModellDirectory = new System.IO.FileInfo(path).DirectoryName;
				
			");

        
        #line default
        #line hidden
        
        #line 229 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(targetClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 229 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(" refModel = model.");

        
        #line default
        #line hidden
        
        #line 229 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Source.PropertyName));

        
        #line default
        #line hidden
        
        #line 229 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@";
            string curPath = Tum.PDE.ToolFramework.Modeling.Visualization.VMXExtensions.Path.PathHelper.EvaluateRelativePath(
				vModellDirectory, (refModel as DslEditorModeling::IParentModelElement).DomainFilePath);
			return curPath;
		}
		
        /// <summary>
        /// Loads the model from the given file path and sets it to its appropriate element.
        /// </summary>
        /// <param name=""filePath"">File path to load the model from. Can be null to indicate that there is no referenced domain model.</param>
        protected override void SetReferencedModel(string filePath)
		{
			using (new Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel.UI.WaitCursor())
            {
				");

        
        #line default
        #line hidden
        
        #line 243 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(sourceClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 243 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(" model = this.Elements[0] as ");

        
        #line default
        #line hidden
        
        #line 243 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(sourceClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 243 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@";
                string file = filePath;

                DslEditorModeling::IParentModelElement parent = model.GetDomainModelServices().ElementParentProvider.GetParentModelElement(model);
                if (parent == null)
                    throw new System.ArgumentNullException(""Parent of element "" + model.ToString() + "" can not be null"");
				
				string path = parent.DomainFilePath;
                string vModellDirectory = new System.IO.FileInfo(path).DirectoryName;
                //string curPath = Tum.PDE.ToolFramework.Modeling.Visualization.VMXExtensions.Path.PathHelper.EvaluateRelativePath(
				//	vModellDirectory, file);

                // load model
                try
                {
					if (!System.IO.File.Exists(file))
                    {
                        System.IO.FileStream s = System.IO.File.Create(file);
                        s.Close();
                    }
				
                    using (DslModeling::Transaction transaction = this.Store.TransactionManager.BeginTransaction(""Set referenced model""))
                    {
						");

        
        #line default
        #line hidden
        
        #line 266 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(targetClass.GetMetaModel().GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 266 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("DocumentData data = this.ViewModelStore.ModelData as ");

        
        #line default
        #line hidden
        
        #line 266 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(targetClass.GetMetaModel().GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 266 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("DocumentData;\r\n                        ");

        
        #line default
        #line hidden
        
        #line 267 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(targetClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 267 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(" referenceModel = data.ModelContext");

        
        #line default
        #line hidden
        
        #line 267 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(targetClass.ModelContext.Name));

        
        #line default
        #line hidden
        
        #line 267 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(".LoadInternal(file) as  ");

        
        #line default
        #line hidden
        
        #line 267 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(targetClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 267 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(";\r\n                        model.");

        
        #line default
        #line hidden
        
        #line 268 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Source.PropertyName));

        
        #line default
        #line hidden
        
        #line 268 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@" = referenceModel;

                        transaction.Commit();

                    }
                }
                catch (System.Exception ex)
                {
                    DslEditorViewModelServices::IMessageBoxService messageBox = this.GlobalServiceProvider.Resolve<DslEditorViewModelServices::IMessageBoxService>();
                    messageBox.ShowError(ex.Message);
                }

                this.ModelData.FlushUndoRedoStacks();
            }			
		}

        /// <summary>
        /// Ensures that the user truly wants to remove a reference to a domain model.
        /// </summary>
        /// <returns>True to remove; False otherwise.</returns>
        protected override bool EnsureClosing()
		{
			if (!IsReferencedModelSet)
                return true;

			");

        
        #line default
        #line hidden
        
        #line 293 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(sourceClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 293 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(" refModel = this.Elements[0] as ");

        
        #line default
        #line hidden
        
        #line 293 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(sourceClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 293 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@";
            
			// we need to gather references that will be deleted if the referenced model is removed
            
            // 1. gather excluded domain models
            System.Collections.Generic.List<DslModeling::ModelElement> excludedDomainModels = new System.Collections.Generic.List<DslModeling::ModelElement>();
			foreach(DslModeling::ModelElement domainModel in this.Store.ElementDirectory.FindElements(");

        
        #line default
        #line hidden
        
        #line 299 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(sourceClass.GetFullName(true)));

        
        #line default
        #line hidden
        
        #line 299 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(".DomainClassId))\r\n\t\t\t{\r\n\t\t\t\tif( domainModel == refModel )\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\r\n\t" +
        "\t\t\tDslModeling::ModelElement parent = domainModel;\r\n\t\t\t\twhile(parent != null )\r\n" +
        "\t\t\t\t{\t\t\t\r\n\t\t\t\t\tparent = ");

        
        #line default
        #line hidden
        
        #line 307 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Name));

        
        #line default
        #line hidden
        
        #line 307 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@"ElementParentProvider.Instance.GetParentModelElement(parent) as DslModeling::ModelElement;
					if( parent == refModel )
					{
						excludedDomainModels.Add(parent);
						break;
					}
				}					
			}
            
            // 2. add elements of those excluded domain models to get existing dependencies on them to 
            // the actual domain models
            System.Collections.Generic.List<DslModeling::ModelElement> elements = ");

        
        #line default
        #line hidden
        
        #line 318 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Name));

        
        #line default
        #line hidden
        
        #line 318 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("ElementChildrenProvider.Instance.GetChildren(refModel.");

        
        #line default
        #line hidden
        
        #line 318 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Source.PropertyName));

        
        #line default
        #line hidden
        
        #line 318 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@", false);

            // 3. ensure user wants to continue
            using( DslEditorViewModelDeletion::DeletionViewModel vm = new DslEditorViewModelDeletion::DeletionViewModel(this.ViewModelStore) )
			{
        	    vm.Set(elements, new RetrivalOptions(excludedDomainModels));
        	    vm.Description = ""Attention: This deletion can not be undone! \r\n \r\n"" + vm.Description;

        	    bool? result = this.GlobalServiceProvider.Resolve<DslEditorViewModelServices::IUIVisualizerService>().ShowDialog(""DeleteElementsPopup"", vm);
        	    if (!result == true)
        	        return false;

        	    }
            System.GC.Collect();

            // 4. delete referenced model and flush undo/redo stacks
            using (new Tum.PDE.ToolFramework.Modeling.Visualization.ViewModel.UI.WaitCursor())
            {
                using (DslModeling::Transaction transaction = this.Store.TransactionManager.BeginTransaction(""Delete referenced model""))
                {
                    refModel.");

        
        #line default
        #line hidden
        
        #line 338 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(role.Relationship.Source.PropertyName));

        
        #line default
        #line hidden
        
        #line 338 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@".Delete();
                    transaction.Commit();
                }
            }
            this.ModelData.FlushUndoRedoStacks();

            return true;
		}

        /// <summary>
        /// Ensures that the user can open the selected file and refence the domain model.
        /// </summary>
        /// <returns>True to reference; False otherwise.</returns>
        protected override bool EnsureOpening(string filePath)
		{
			try
            {
                HtmlAgilityPack.HtmlDocument htmlDocument = new HtmlAgilityPack.HtmlDocument();
                htmlDocument.Load(filePath);

                HtmlAgilityPack.HtmlNodeCollection nodes = htmlDocument.DocumentNode.SelectNodes(""//@id"");

                // verify that none of the ids is present at the moment
                if (nodes != null)
                    foreach (HtmlAgilityPack.HtmlNode node in nodes)
                    {
                        string value = node.Attributes[""id""].Value;
                        if (");

        
        #line default
        #line hidden
        
        #line 365 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Name));

        
        #line default
        #line hidden
        
        #line 365 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write("DomainModelIdProvider.Instance.HasVModellKey(value))\r\n                        {\r\n" +
        "                            DslEditorViewModelServices::IMessageBoxService messa" +
        "geBox = this.GlobalServiceProvider.Resolve<DslEditorViewModelServices::IMessageB" +
        "oxService>();\r\n                            messageBox.ShowInformation(\"Can not r" +
        "eference the selected model because some of its elements are already included in" +
        " the currently opened model. (Failed on element \'\" + node.Name + \"\').\\r\\n\\r\\nHin" +
        "t: This could also be caused by a referenced model in the domain model selected " +
        "to be referenced.\");\r\n\r\n                            return false;\r\n             " +
        "           }\r\n                    }\r\n\r\n                // proceed with reference" +
        "d models\r\n                HtmlAgilityPack.HtmlNode refNode = htmlDocument.Docume" +
        "ntNode.SelectSingleNode(\"//v-modellvariante/referenzmodell\");\r\n                i" +
        "f (refNode != null)\r\n                    foreach (HtmlAgilityPack.HtmlNode n in " +
        "refNode.ChildNodes)\r\n                    {\r\n                        if (n.Name !" +
        "= \"xi:include\")\r\n                            continue;\r\n\r\n                      " +
        "  string href = n.Attributes[\"href\"].Value;\r\n                        string curP" +
        "ath = href;\r\n                        if (!curPath.Contains(System.IO.Path.Volume" +
        "SeparatorChar.ToString()))\r\n                        {\r\n                         " +
        "   curPath = new System.IO.FileInfo(filePath).DirectoryName + System.IO.Path.Dir" +
        "ectorySeparatorChar + curPath;\r\n                        }\r\n\r\n                   " +
        "     if (System.IO.File.Exists(curPath))\r\n                            if (!Ensur" +
        "eOpening(curPath))\r\n                                return false;\r\n             " +
        "       }\r\n            }\r\n            catch(System.Exception ex)\r\n            {\r\n" +
        "                DslEditorViewModelServices::IMessageBoxService messageBox = this" +
        ".GlobalServiceProvider.Resolve<DslEditorViewModelServices::IMessageBoxService>()" +
        ";\r\n                messageBox.ShowInformation(\"Couldnt parse file: \" + ex.Messag" +
        "e);\r\n\r\n                return false;\r\n            }\r\n            return true;\r\n\t" +
        "\t}\r\n\t\t#endregion\r\n\t\t\r\n\t\t#region Helper Class\r\n\t\tprivate class RetrivalOptions : " +
        "DslEditorModeling::DependenciesRetrivalOptions\r\n\t\t{\r\n\t\t\tSystem.Collections.Gener" +
        "ic.List<DslModeling::ModelElement> excludedDomainModels;\r\n\t\t\t\r\n\t\t\t/// <summary>\r" +
        "\n        \t/// Constructor.\r\n        \t/// </summary>\r\n\t\t\t/// <param name=\"exclude" +
        "dDomainModels\">Excluded domain models </param>\r\n        \tpublic RetrivalOptions(" +
        "System.Collections.Generic.List<DslModeling::ModelElement> excludedDomainModels)" +
        " : base()\r\n\t\t\t{\r\n\t\t\t\tthis.excludedDomainModels = excludedDomainModels;\r\n\t\t\t}\r\n\t\t" +
        "\t\r\n\t\t\t/// <summary>\r\n    \t    /// Verifies if a specific model element should be" +
        " excluded or not.\r\n    \t    /// </summary>\r\n    \t    /// <param name=\"modelEleme" +
        "nt\">Model element to verify</param>\r\n    \t    /// <returns>True if the specified" +
        " element should be excluded; False otherwise.</returns>\r\n    \t    public overrid" +
        "e bool ShouldExcludeDomainClass(DslModeling::ModelElement modelElement)\r\n    \t  " +
        "  {\r\n    \t        DslModeling::ModelElement parent = ");

        
        #line default
        #line hidden
        
        #line 426 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(dm.Name));

        
        #line default
        #line hidden
        
        #line 426 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"
this.Write(@"ElementParentProvider.Instance.GetParentModelElement(modelElement) as DslModeling::ModelElement;								
				if( parent == null )
					return false;
					
				if( excludedDomainModels.Contains(parent) )
					return true;

    	        return false;
    	    }			
			
		}
		#endregion
	}
}
");

        
        #line default
        #line hidden
        
        #line 440 "J:\Uni\CC Processes\Werkzeuge\PDE 2\Tum.PDE.ToolFramework\Tum.PDE.ToolFramework.Templates\ViewModel\PropertyGridEditorViewModelGenerator.tt"

	}
}

        
        #line default
        #line hidden
    }
    
    #line default
    #line hidden
}
